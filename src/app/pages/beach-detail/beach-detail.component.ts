import { Component, OnInit } from '@angular/core';
import { ActivatedRoute } from '@angular/router';
import { CommonModule } from '@angular/common';
import { WeatherService, WeatherResponse } from '../../app/services/weather.service';

@Component({
  selector: 'app-beach-detail',
  standalone: true,
  imports: [CommonModule],
  templateUrl: './beach-detail.component.html',
  styleUrls: ['./beach-detail.component.css']
})
export class BeachDetailComponent implements OnInit {
  beach: any;

  // mantive os dados que voc√™ tinha (at√© id 9 conforme seu exemplo),
  // adicionei `city: 'Salvador'` nas duas primeiras praias para demonstrar dados din√¢micos
  beaches = [
    {
      id: 1,
      name: 'Praia Farol da Barra',
      city: 'Salvador',
      images: ['https://images.pexels.com/photos/23228012/pexels-photo-23228012.jpeg'],
      location: 'Salvador - BA',
      description: 'A Praia do Farol da Barra, situada no bairro da Barra em Salvador, Bahia, √© inquestionavelmente um dos pontos tur√≠sticos e de lazer mais emblem√°ticos da cidade. Ela se estende a partir do imponente Forte de Santo Ant√¥nio da Barra, onde se localiza o hist√≥rico Farol da Barra, o que confere √† paisagem uma moldura arquitet√¥nica e cultural inigual√°vel. O mar neste ponto √© conhecido pela sua diversidade: um trecho √© protegido por arrecifes, que formam deliciosas piscinas naturais de √°guas cristalinas e mornas durante a mar√© baixa, ideais para banho e mergulho livre. J√° o outro trecho, em dire√ß√£o ao Morro do Cristo, oferece mar aberto com ondas mais fortes, o que atrai praticantes de surfe. A praia √© extremamente popular, n√£o s√≥ por sua beleza e infraestrutura com quiosques e cal√ßad√£o, mas principalmente por ser o palco do p√¥r do sol mais famoso de Salvador. Turistas e moradores se re√∫nem diariamente para assistir ao espet√°culo onde o sol se p√µe no horizonte do mar, tingindo o c√©u e as paredes do forte com cores vibrantes, criando um ambiente de contempla√ß√£o e celebra√ß√£o que √© a cara da capital baiana. Al√©m disso, a √°rea √© vital para a cultura e festividades, sendo o ponto de largada do tradicional Carnaval de Salvador no circuito Barra-Ondina.',
      weather: { temp: '28¬∞C', condition: '‚òÄÔ∏è Ensolarado', wind: '12 km/h', rain: '10%' },
      tide: { now: 'Baixa', next: 'Cheia √†s 15:00' }
    },
    {
      id: 2,
      name: 'Praia do Porto da Barra',
      city: 'Salvador',
      images: ['https://images.pexels.com/photos/13733832/pexels-photo-13733832.jpeg'],
      location: 'Salvador - BA',
      description: 'A Praia do Porto da Barra √© frequentemente considerada a queridinha dos soteropolitanos e de turistas, tendo sido, inclusive, citada por jornais internacionais como uma das melhores praias urbanas do mundo. Localizada no bairro da Barra, ela √© uma enseada de faixa de areia relativamente curta, mas de grande charme e import√¢ncia hist√≥rica. O que mais a define s√£o as suas √°guas: por estar dentro da Ba√≠a de Todos-os-Santos, o mar √© excepcionalmente calmo, morno e cristalino, o que a torna perfeita para banho, fam√≠lias com crian√ßas e a pr√°tica de esportes n√°uticos como stand up paddle e caiaque. A hist√≥ria do local √© vis√≠vel e palp√°vel, j√° que a praia √© delimitada por duas fortifica√ß√µes coloniais: o Forte de Santa Maria √† esquerda e o Forte de S√£o Diogo √† direita, que hoje abrigam espa√ßos culturais, adicionando um toque cultural √∫nico ao cen√°rio. O Porto da Barra tamb√©m √© famoso por proporcionar um dos espet√°culos mais concorridos da cidade: o p√¥r do sol. Milhares de pessoas se re√∫nem diariamente para assistir ao sol se pondo diretamente no mar da ba√≠a, num show de cores que √© uma experi√™ncia imperd√≠vel em Salvador. Apesar de ser sempre muito movimentada e concorrida, a Praia do Porto da Barra √© um ref√∫gio de √°guas mansas no cora√ß√£o da capital baiana.',
      weather: { temp: '27¬∞C', condition: 'üå§Ô∏è Parcialmente nublado', wind: '9 km/h', rain: '5%' },
      tide: { now: 'Cheia', next: 'Vazante √†s 16:00' }
    },
    {
      id: 3,
      name: 'Praia de Stella Maris',
      images: ['https://images.pexels.com/photos/3765562/pexels-photo-3765562.jpeg'],
      location: 'Salvador - BA',
      description: 'A Praia de Stella Maris √© um dos trechos do litoral de Salvador que oferece uma atmosfera mais de "praia de oceano" e est√° localizada em um bairro hom√¥nimo, mais distante do centro da cidade. √â uma praia de faixa de areia extensa, ideal para longas caminhadas, cercada por um lindo coqueiral e vegeta√ß√£o de restinga, o que lhe confere um visual bastante paradis√≠aco e menos "urbano" que as praias da Barra. O mar de Stella Maris √© famoso por ter boas ondas e mar aberto, sendo um dos principais picos de surfe da capital baiana e palco de alguns torneios do esporte. No entanto, ela tamb√©m agrada quem busca tranquilidade para o banho. Em per√≠odos de mar√© baixa, especialmente no ver√£o, as forma√ß√µes de arrecifes e corais criam diversas piscinas naturais de √°guas transparentes e mornas, perfeitas para banhistas e fam√≠lias. A praia conta com uma excelente infraestrutura de barracas, sendo o local de uma das unidades da famosa Barraca do L√¥ro, al√©m de ter sido recentemente revitalizada, com a instala√ß√£o de ciclovia, cal√ßad√µes e √°reas esportivas, atraindo tanto surfistas quanto frequentadores que buscam lazer, esporte e um ambiente mais badalado no litoral norte de Salvador. √â uma praia que equilibra a natureza preservada com a efervesc√™ncia da vida social de Salvador.',
      weather: { temp: '29¬∞C', condition: '‚òÄÔ∏è Ensolarado', wind: '14 km/h', rain: '0%' },
      tide: { now: 'Cheia', next: 'Vazante √†s 14:30' }
    },
    {
      id: 4,
      name: 'Praia de Itapu√£',
      images: ['https://images.pexels.com/photos/23605138/pexels-photo-23605138.jpeg'],
      location: 'Salvador - BA',
      description: `A Praia de Itapu√£ √© uma das mais ic√¥nicas e encantadoras de Salvador. Localizada a cerca de 20 km do centro, √© famosa por ter inspirado poetas e m√∫sicos ‚Äî especialmente Vin√≠cius de Moraes e Toquinho, que a eternizaram na can√ß√£o ‚ÄúTarde em Itapu√£‚Äù.

      Seu cen√°rio √© composto por areias brancas, coqueiros e recifes que formam piscinas naturais de √°guas mornas e cristalinas durante a mar√© baixa. √â uma praia perfeita para fam√≠lias e casais que buscam tranquilidade e um ambiente paradis√≠aco.

      Al√©m do mar, Itapu√£ abriga o Farol de Itapu√£, cart√£o-postal hist√≥rico e ponto muito visitado para fotos e contempla√ß√£o do p√¥r do sol. Na orla, h√° diversas barracas e restaurantes tradicionais, onde se pode saborear moquecas, acaraj√©s e outras del√≠cias t√≠picas da culin√°ria baiana.

      √Ä noite, a regi√£o ganha um clima rom√¢ntico e acolhedor, ideal para um passeio √† beira-mar.`,
      weather: { temp: '27¬∞C', condition: '‚õÖ Nublado', wind: '10 km/h', rain: '20%' },
      tide: { now: 'Baixa', next: 'Cheia √†s 16:45' }
    },
    {
      id: 5,
      name: 'Praia do Rio Vermelho',
      images: ['https://images.pexels.com/photos/28500818/pexels-photo-28500818.jpeg'],
      location: 'Salvador - BA',
      description: `Localizada no bairro bo√™mio mais famoso de Salvador, a Praia do Rio Vermelho √© o cora√ß√£o cultural e noturno da cidade. Embora o mar seja mais agitado e nem sempre pr√≥prio para banho, o local √© conhecido pela sua vida vibrante, bares descolados e tradi√ß√µes religiosas.

      √â l√° que acontece, todos os anos, a Festa de Iemanj√°, no dia 2 de fevereiro ‚Äî uma das maiores celebra√ß√µes do candombl√©, quando milhares de pessoas vestidas de branco fazem oferendas √† Rainha do Mar.

      Durante o dia, o Rio Vermelho √© √≥timo para caminhadas e para saborear o tradicional acaraj√© das baianas Dinha e Cira, consideradas patrim√¥nio cultural da Bahia. √Ä noite, o bairro se transforma em um dos principais pontos de encontro de jovens, artistas e turistas, com bares, m√∫sica ao vivo e um ambiente alegre e acolhedor.`,
      weather: { temp: '26¬∞C', condition: 'üå§Ô∏è Parcialmente nublado', wind: '15 km/h', rain: '15%' },
      tide: { now: 'Cheia', next: 'Vazante √†s 18:00' }
    },
    {
      id: 6,
      name: 'Praia do Burac√£o',
      images: ['https://dynamic-media-cdn.tripadvisor.com/media/photo-o/16/a8/0c/53/caption.jpg?w=1200&h=-1&s=1'],
      location: 'Salvador - BA',
      description: `Escondida entre o Rio Vermelho e Amaralina, a Praia do Burac√£o √© um tesouro urbano de Salvador. Pequena, charmosa e cercada por pedras, √© muito frequentada por moradores locais e jovens que buscam um lugar mais reservado, com boa m√∫sica e uma energia descontra√≠da.

      O mar √© forte e com correnteza, portanto o banho requer aten√ß√£o, mas em dias de mar√© baixa √© poss√≠vel encontrar pequenas piscinas naturais entre as pedras.

      Ao redor, h√° barzinhos e quiosques estilizados, ideais para curtir o p√¥r do sol com um drink e boa companhia. √â uma praia com uma vibe alternativa e moderna, perfeita para quem gosta de fugir do turismo mais convencional.`,
      weather: { temp: '28¬∞C', condition: '‚òÄÔ∏è Ensolarado', wind: '11 km/h', rain: '0%' },
      tide: { now: 'Baixa', next: 'Cheia √†s 15:20' }
    },
    {
      id: 7,
      name: 'Praia Amaralina',
      images: ['https://www.guiaviagensbrasil.com/imagens/foto-praia-da-amaralina-salvador-bahia-brasil-2212.jpg'],
      location: 'Salvador - BA',
      description: `A Praia de Amaralina √© um dos pontos tradicionais da orla de Salvador, muito frequentada por moradores da cidade e surfistas. O mar √© aberto e as ondas s√£o fortes, o que atrai esportistas, mas exige cuidado dos banhistas.

      O cal√ßad√£o √© extenso e √≥timo para caminhadas, corridas e passeios de bicicleta. Na orla, as barracas servem comidas t√≠picas baianas, como moqueca, peixe frito e acaraj√©, com pre√ßos acess√≠veis e clima familiar.

      Al√©m do banho de mar, Amaralina √© conhecida pela vista panor√¢mica e o colorido das jangadas, que d√£o um toque especial ao cen√°rio. O bairro tamb√©m respira cultura, sendo reduto de artistas locais e de eventos populares.`,
      weather: { temp: '29¬∞C', condition: 'üå§Ô∏è Parcialmente nublado', wind: '13 km/h', rain: '10%' },
      tide: { now: 'Cheia', next: 'Vazante √†s 17:00' }
    },
    {
      id: 8,
      name: 'Praia de Ondina',
      images: ['https://dynamic-media-cdn.tripadvisor.com/media/photo-o/17/60/93/4f/poucos-conhecem-mas-esta.jpg?w=700&h=400&s=1'],
      location: 'Salvador - BA',
      description: `Situada entre o Rio Vermelho e o Farol da Barra, a Praia de Ondina √© uma das mais conhecidas da cidade. Com recifes naturais que formam pequenas piscinas durante a mar√© baixa, √© excelente para banho tranquilo e mergulho leve.

      Al√©m de bela, Ondina √© palco do Carnaval de Salvador, com camarotes e trios el√©tricos passando pela Avenida Oce√¢nica. Fora da folia, a praia mant√©m um clima mais familiar e tranquilo, ideal para quem busca um banho de mar seguro e estrutura completa de bares, hot√©is e restaurantes.

      O p√¥r do sol de Ondina √© um espet√°culo √† parte, sendo um dos mais bonitos da orla soteropolitana.`,
      weather: { temp: '27¬∞C', condition: '‚òÅÔ∏è Nublado', wind: '12 km/h', rain: '30%' },
      tide: { now: 'Baixa', next: 'Cheia √†s 19:00' }
    },
    {
      id: 9,
      name: 'Praia Jardim de Al√°',
      images: ['https://www.guiaviagensbrasil.com/imagens/foto-da-praia-jardim-de-alah-em-salvador-bahia-brasil-2257.jpg'],
      location: 'Pituba',
      description: `A Praia do Jardim de Al√° √© uma das mais fotog√™nicas e ex√≥ticas de Salvador. Cercada por coqueirais, dunas e gramados, √© um ponto perfeito para quem quer relaxar e aproveitar a natureza sem se afastar da cidade.

      O mar √© forte e o banho exige cautela, mas o local √© excelente para caminhadas, contempla√ß√£o e piqueniques. O cal√ßad√£o e a ciclovia convidam ao exerc√≠cio f√≠sico, e o visual natural rende √≥timas fotos.

      H√° tamb√©m um parque √† beira-mar, ideal para descansar sob a sombra dos coqueiros. √Ä noite, o bairro ganha um ar mais sossegado, com alguns restaurantes e bares elegantes nas redondezas.`,
      weather: { temp: '27¬∞C', condition: '‚òÅÔ∏è Nublado', wind: '12 km/h', rain: '30%' },
      tide: { now: 'Baixa', next: 'Cheia √†s 19:00' }
    },
    {
      id: 10,
      name: 'Praia de Piat√£',
      images: ['https://www.guiaviagensbrasil.com/imagens/foto-praia-pieta-salvador-bahia-brasil-9425.jpg'],
      location: 'Salvador - BA',
      description: 'Extensa faixa de areia e mar geralmente calmo em mar√© baixa; muito frequentada, √≥tima infraestrutura.',
      weather: { temp: '28¬∞C', condition: 'üå§Ô∏è Parcialmente nublado', wind: '13 km/h', rain: '15%' },
      tide: { now: 'Meia-mar√©', next: 'Cheia √†s 18:30' }
    },
    {
      id: 11,
      name: 'Praia de Arma√ß√£o',
      images: ['https://i0.wp.com/melhoresdestinosdobrasil.com.br/wp-content/uploads/2015/12/praia-armacao-salvador-bahia.jpg?resize=800%2C560&ssl=1'],
      location: 'Salvador - BA',
      description: 'Conhecida por √°guas agitadas e ventos, boa para esportes n√°uticos e caminhadas na orla.',
      weather: { temp: '27¬∞C', condition: 'üå¨Ô∏è Ventos moderados', wind: '22 km/h', rain: '10%' },
      tide: { now: 'Vazante', next: 'Baixa √†s 15:40' }
    },
    {
      id: 12,
      name: 'Praia de Jaguaribe',
      images: ['https://dynamic-media-cdn.tripadvisor.com/media/photo-o/12/32/f2/ce/praia-de-jaguaribe-salvador.jpg?w=900&h=500&s=1'],
      location: 'Salvador - BA',
      description: 'Famosa pelas ondas e pelo cen√°rio com coqueiros; ponto tradicional de surf em Salvador.',
      weather: { temp: '28¬∞C', condition: 'üåä Ondas moderadas', wind: '18 km/h', rain: '5%' },
      tide: { now: 'Subindo', next: 'Cheia √†s 17:20' }
    },
    {
      id: 13,
      name: 'S√£o Tom√© de Paripe',
      images: ['https://s2-g1.glbimg.com/ciezn2_RS4XMqH6qAoBhfyvmlEc=/0x0:1700x1065/984x0/smart/filters:strip_icc()/i.s3.glbimg.com/v1/AUTH_59edd422c0c84a879bd37670ae4f538a/internal_photos/bs/2017/L/0/EtDyqaTXyIRnxxBzFbbw/img-6130.jpg'],
      location: 'Sub√∫rbio Ferrovi√°rio - Salvador',
      description: '√Åguas calmas da Ba√≠a de Todos-os-Santos; ideal para fam√≠lias e passeios de barco.',
      weather: { temp: '29¬∞C', condition: '‚òÄÔ∏è Ensolarado', wind: '9 km/h', rain: '5%' },
      tide: { now: 'Cheia', next: 'Vazante √†s 16:10' }
    },
    {
      id: 14,
      name: 'Praia da Pituba',
      images: ['https://media-cdn.tripadvisor.com/media/photo-s/07/84/2b/62/praia-pituba.jpg'],
      location: 'Salvador - BA',
      description: `Localizada em um dos bairros mais modernos de Salvador, a Praia da Pituba √© marcada por mar agitado e orla urbanizada. √â bastante frequentada para atividades f√≠sicas, como corrida, ciclismo e caminhadas, gra√ßas ao cal√ßad√£o bem estruturado.

      Embora o banho n√£o seja indicado em todos os trechos, o visual √© encantador, e h√° diversas barracas e quiosques que servem petiscos e bebidas geladas.

      √â uma praia com perfil mais urbano e familiar, muito apreciada por quem vive na capital baiana e busca lazer di√°rio √† beira-mar.`,
      weather: { temp: '27¬∞C', condition: '‚õÖ Nublado', wind: '16 km/h', rain: '20%' },
      tide: { now: 'Baixa', next: 'Cheia √†s 18:50' }
    },
    {
      id: 15,
      name: 'Praia de Patamares',
      images: ['https://www.essemundoenosso.com.br/wp-content/uploads/2014/03/praia-de-patamares-1.jpg'],
      location: 'Salvador - BA',
      description: `Com um visual selvagem e mar agitado, a Praia de Patamares √© uma das mais tranquilas da cidade. Sua extensa faixa de areia e o ambiente mais reservado atraem fam√≠lias e moradores locais que buscam descanso longe do movimento central.

      O local √© √≥timo para passeios √† beira-mar, esportes de areia e pesca, mas o banho requer aten√ß√£o por causa das ondas. H√° algumas barracas simples, com comida caseira e ambiente acolhedor.

      O p√¥r do sol visto dali √© um dos mais bonitos da orla leste, e o clima de paz faz dela uma √≥tima op√ß√£o para quem quer relaxar e se desconectar.`,
      weather: { temp: '28¬∞C', condition: 'üå§Ô∏è Parcialmente nublado', wind: '17 km/h', rain: '10%' },
      tide: { now: 'Vazante', next: 'Baixa √†s 16:30' }
    },
    {
      id: 16,
      name: 'Praia de Tubar√£o',
      images: ['https://lh5.googleusercontent.com/p/AF1QipMgxoDlLbFNP6DcNBoJ0WQp6USheSXt1s2q9RlI=s1600'],
      location: 'Ilhas de Mar√© (acesso por Salvador)',
      description: 'Praia mais reservada com √°guas calmas; ref√∫gio para quem busca tranquilidade.',
      weather: { temp: '30¬∞C', condition: '‚òÄÔ∏è Ensolarado', wind: '8 km/h', rain: '0%' },
      tide: { now: 'Cheia', next: 'Vazante √†s 17:10' }
    },
    {
      id: 17,
      name: 'Praia de Pitua√ßu',
      images: ['https://static.wixstatic.com/media/954288_c0ea959ada884f9aaedc9b548d956d86~mv2.jpg/v1/fill/w_699,h_393,al_c,lg_1,q_80,enc_auto/954288_c0ea959ada884f9aaedc9b548d956d86~mv2.jpg'],
      location: 'Salvador - BA',
      description: `Vizinha de Patamares, a Praia de Pitua√ßu combina natureza e tranquilidade. O mar √© forte e profundo, sendo mais procurada por surfistas e pescadores. A paisagem √© marcada por dunas e vegeta√ß√£o nativa, proporcionando um clima r√∫stico e agrad√°vel.

      Fica pr√≥xima ao Parque Metropolitano de Pitua√ßu, onde h√° trilhas e √°reas verdes ideais para caminhadas e ciclismo. √â uma √≥tima op√ß√£o para quem gosta de praias mais vazias e contato direto com a natureza.`,
      weather: { temp: '27¬∞C', condition: '‚õÖ Nublado', wind: '14 km/h', rain: '20%' },
      tide: { now: 'Subindo', next: 'Cheia √†s 17:40' }
    },
    {
      id: 18,
      name: 'Praia da Boca do Rio',
      images: ['https://dynamic-media-cdn.tripadvisor.com/media/photo-o/1c/35/22/bb/caption.jpg?w=800&h=400&s=1'],
      location: 'Salvador - BA',
      description: 'Trecho de mar aberto com vista para o encontro do rio com o mar; ambiente tranquilo.',
      weather: { temp: '28¬∞C', condition: 'üå§Ô∏è Parcialmente nublado', wind: '12 km/h', rain: '10%' },
      tide: { now: 'Vazante', next: 'Baixa √†s 16:55' }
    },
    {
      id: 19,
      name: 'Praia da Paci√™ncia',
      images: ['https://www.salvadordabahia.com/wp-content/uploads/2017/12/cultural-rio-vermelho-07-12-20.jpg'],
      location: 'Rio Vermelho - Salvador',
      description: `Pequena e acolhedora, a Praia da Paci√™ncia √© um ref√∫gio entre Amaralina e Rio Vermelho. Com √°guas geralmente calmas e recifes que formam pequenas piscinas naturais, √© perfeita para um banho relaxante e seguro.

      Tem uma energia tranquila, frequentada por moradores e visitantes que buscam fugir do agito das praias maiores. O p√¥r do sol √© encantador, e o clima lembra o de uma praia de bairro com charme e autenticidade.

      Nas redondezas, h√° bons bares e restaurantes, tornando-a uma excelente op√ß√£o para quem quer curtir o mar e depois aproveitar um almo√ßo ou jantar t√≠pico baiano.`,
      weather: { temp: '27¬∞C', condition: '‚òÅÔ∏è Nublado', wind: '10 km/h', rain: '25%' },
      tide: { now: 'Baixa', next: 'Cheia √†s 18:20' }
    },
    {
      id: 20,
      name: 'Ilha dos Frades',
      images: ['https://s2.glbimg.com/wTvHVw5KP_o0tlZK2Zk6tyRParc=/smart/e.glbimg.com/og/ed/f/original/2022/01/14/ilha-dos-frades-2.jpg'],
      location: 'Ba√≠a de Todos-os-Santos - Salvador',
      description: `Localizada na Ba√≠a de Todos os Santos, a Ilha dos Frades √© um para√≠so natural com √°guas cristalinas e areia branca, acess√≠vel apenas por barco. O nome vem dos frades franciscanos que viveram ali no per√≠odo colonial.

      A ilha abriga praias deslumbrantes, como Nossa Senhora de Guadalupe, que ostenta a certifica√ß√£o Bandeira Azul, s√≠mbolo internacional de qualidade ambiental.

      Al√©m do banho e do mergulho, o visitante pode explorar trilhas ecol√≥gicas, visitar a igreja colonial de Guadalupe e saborear frutos do mar frescos nas barracas locais.

      √â um passeio imperd√≠vel para quem visita Salvador e deseja um contato mais pr√≥ximo com a natureza em um ambiente preservado e tranquilo.`,
      weather: { temp: '29¬∞C', condition: '‚òÄÔ∏è Ensolarado', wind: '9 km/h', rain: '5%' },
      tide: { now: 'Cheia', next: 'Vazante √†s 17:30' }
    }
  ];

  constructor(
    private route: ActivatedRoute,
    private weatherService: WeatherService
  ) {}

  ngOnInit() {
    const id = Number(this.route.snapshot.paramMap.get('id'));
    this.beach = this.beaches.find(b => b.id === id);

    if (this.beach?.city) {
      this.weatherService.getCurrentWeather(this.beach.city).subscribe({
        next: (data: WeatherResponse) => {
      
          const tempStr = `${Math.round(data.main.temp)}¬∞C`;

          const condition = this.mapWeatherIcon(data.weather[0].description);

          const windKmh = Math.round((data.wind?.speed ?? 0) * 3.6);
          const windStr = `${windKmh} km/h`;

  
          const rainPercent = data.rain?.['1h']
            ? Math.min(100, Math.round(data.rain['1h'] * 10)) 
            : (data.clouds?.all ?? 0);
          const rainStr = `${rainPercent}%`;

          this.beach.weather = {
            temp: tempStr,
            condition,
            wind: windStr,
            rain: rainStr
          };
        },
        error: (err) => {
          console.error('Erro ao buscar clima:', err);
          this.beach.weather = {
            temp: this.beach.weather?.temp ?? '--',
            condition: 'N√£o dispon√≠vel',
            wind: this.beach.weather?.wind ?? '--',
            rain: this.beach.weather?.rain ?? '--'
          };
        }
      });
    }
  }

  atualizarDados() {
  
    if (this.beach?.city) {
      this.weatherService.getCurrentWeather(this.beach.city).subscribe({
        next: (data: WeatherResponse) => {
          const tempStr = `${Math.round(data.main.temp)}¬∞C`;
          const condition = this.mapWeatherIcon(data.weather[0].description);
          const windKmh = Math.round((data.wind?.speed ?? 0) * 3.6);
          const windStr = `${windKmh} km/h`;
          const rainPercent = data.rain?.['1h'] ? Math.min(100, Math.round(data.rain['1h'] * 10)) : (data.clouds?.all ?? 0);
          const rainStr = `${rainPercent}%`;

          this.beach.weather = {
            temp: tempStr,
            condition,
            wind: windStr,
            rain: rainStr
          };
        },
        error: (err) => {
          console.error('Erro ao atualizar clima:', err);
        }
      });
    }
  }

  private mapWeatherIcon(description: string): string {
    const desc = description.toLowerCase();
    if (desc.includes('c√©u limpo') || desc.includes('clear') || desc.includes('sol')) return '‚òÄÔ∏è Ensolarado';
    if (desc.includes('nublado') || desc.includes('cloud')) return '‚õÖ Nublado';
    if (desc.includes('chuva') || desc.includes('rain')) return 'üåßÔ∏è Chuva';
    if (desc.includes('neve') || desc.includes('snow')) return '‚ùÑÔ∏è Neve';
    return description;
  }
}
